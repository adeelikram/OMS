const { RefreshToken } = require("../config/Token")
const { gpData } = require("../fortnox")

var arr = [
    'clientName',
    'customer',
    'email',
    'invoiceInfo',
    'invoiceNumber',
    'isInvoiceGenerated',
    'neatseat',
    'nucleus',
    'number',
    'orderDate',
    'orderDeadline',
    'otium',
    'roomMate',
    'roomMateRent',
    'sitShowerRent',
    'manager',
]

var arr2 = [
    '@url',
    '@urlTaxReductionList',
    'AdministrationFee',
    'AdministrationFeeVAT',
    'Address1',
    'Address2',
    'BasisTaxReduction',
    'Cancelled',
    'City',
    'Comments',
    'ContributionPercent',
    'ContributionValue',
    'CopyRemarks',
    'Country',
    'CostCenter',
    'Currency',
    'CurrencyRate',
    'CurrencyUnit',
    'CustomerName',
    'CustomerNumber',
    'IsDelivery',
    'DeliveryAddress1',
    'DeliveryAddress2',
    'DeliveryCity',
    'DeliveryCountry',
    'DeliveryDate',
    'DeliveryName',
    'DeliveryZipCode',
    'DocumentNumber',
    'ExternalInvoiceReference1',
    'ExternalInvoiceReference2',
    'Freight',
    'FreightVAT',
    'Gross',
    'HouseWork',
    'InvoiceReference',
    'Language',
    'Net',
    'NotCompleted',
    'OfferReference',
    'OrderDate',
    'OrderType',
    'OrganisationNumber',
    'OurReference',
    'Phone1',
    'Phone2',
    'PriceList',
    'PrintTemplate',
    'Project',
    'WarehouseReady',
    'OutboundDate',
    'Remarks',
    'RoundOff',
    'Sent',
    'TaxReduction',
    'TermsOfDelivery',
    'TermsOfPayment',
    'TimeBasisReference',
    'Total',
    'TotalToPay',
    'TotalVAT',
    'VATIncluded',
    'WayOfDelivery',
    'YourReference',
    'YourOrderNumber',
    'ZipCode',
    'StockPointCode',
    'StockPointId',
    'TaxReductionType',
]


exports.fortnoxProdController = async function (req, res) {
    var data = (await gpData('https://api.fortnox.se/3/articles', null, req, "GET"))?.Articles
    if (data) for (let el of data) {
        if (!arr2.includes("ArticleNumber: " + el.ArticleNumber)) arr2.push("ArticleNumber: " + el.ArticleNumber)
    }
    res.render("fortnox-prod-list", {
        oms: arr,
        name: req.user.nickname,
        fort: arr2
    })
}